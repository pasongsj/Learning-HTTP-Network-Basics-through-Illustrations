## 6.4.9 if-match
**_λ‚™κ΄€μ  λ½μ—μ„ μ‚¬μ©ν•¨_**

if -xxx ν•μ‹μ λ¦¬ν€μ¤νΈ ν—¤λ” ν•„λ“λ¥Ό "μ΅°κ±΄λ¶€ ν—¤λ”ν•„λ“"λΌκ³  ν•λ‹¤.
μ§€μ •λ μ΅°κ±΄μ— λ§λ” κ²½μ°μ—λ§ λ¦¬ν€μ¤νΈλ¥Ό λ°›μµλ‹λ‹¤.

μ„λ²„ μƒμ λ¦¬μ†μ¤λ¥Ό νΉμ •ν•κΈ° μ„ν•΄μ„ Etag(entity tag)λ¥Ό μ²¨λ¶€ν•λ‹¤.
μ΄κ²ƒκ³Ό κ°™μ•„μ•Όμ§€λ§ λ¦¬μ†μ¤ λ°ν™ν•κ³ , λ§μ•½ ν‹€λ¦¬λ‹¤λ©΄ 412 Precondition Failed μ—λ¬λ¥Ό λ°ν™ν•©λ‹λ‹¤.

*μ„ μ§€μ •ν•΄μ„ λ¨λ“  λ¦¬μ†μ¤μ— λ€ν•΄μ„ ν—μ©ν•  μλ„ μλ‹¤. 

μμ‹)
μ¤ν”„λ§ λ¶€νΈ + JPA ν™κ²½μ—μ„ ETagλ¥Ό μ„¤μ •ν•λ” μΌλ°μ μΈ νλ¦„μ€ λ‹¤μκ³Ό κ°™μ•„:

JPA μ—”ν‹°ν‹°μ— λ‚™κ΄€μ  λ½(Optimistic Lock)μ„ μ„ν• @Version ν•„λ“λ¥Ό λ‘ μ μμ–΄. μ: private Long version;
μ—”ν‹°ν‹°κ°€ μƒλ΅ μ €μ¥λκ±°λ‚ μ—…λ°μ΄νΈλ  λ•λ§λ‹¤ λ²„μ „ ν•„λ“κ°€ μ¦κ°€(λλ” κ°±μ‹ )ν•΄.
μ΄ λ²„μ „ κ°’μ„ ν™μ©ν•΄μ„ ETagλ¥Ό μƒμ„±ν•λ©΄, λ³€κ²½λ  λ•λ§λ‹¤ ETagλ„ λ‹¬λΌμ§€λ―€λ΅ λ¦¬μ†μ¤μ μµμ‹  μƒνƒλ¥Ό λ³΄μ¥ν•  μ μμ–΄.
ETag μƒμ„± λ΅μ§

λ²„μ „ μ •λ³΄, μμ • μ‹κ°„, ν•΄μ‹ κ°’ λ“± λ¦¬μ†μ¤λ¥Ό λ€ν‘ν•λ” μ–΄λ–¤ κ°’μ„ κΈ°μ¤€μΌλ΅ ETag λ¬Έμμ—΄μ„ λ§λ“¤λ©΄ λΌ.
μ¤ν”„λ§ MVC μ»¨νΈλ΅¤λ¬λ‚ μ„λΉ„μ¤ λ μ΄μ–΄μ—μ„ ResponseEntity.ok().eTag("W/\"" + version + "\"") ν•νƒλ΅ ETagλ¥Ό μ§€μ •ν•  μ μμ–΄.
μ—¬κΈ°μ„ W/λ” μ•½ν•(weak) κ²€μ¦ λ°©μ‹μ„ μλ―Έν•λ©°, κΌ­ λ¶™μ΄μ§€ μ•μ•„λ„ λμ§€λ§ λ³΄ν†µ ETag ν‘ν„μ—μ„ μμ£Ό μ‚¬μ©λλ” ν‘μ¤€ μ ‘λ‘μ‚¬μ•Ό.


#### λ‚™κ΄€μ  λ½μ—μ„ Etagλ¥Ό μ‚¬μ© μμ‹
```java
@RestController
@RequestMapping("/persons")
public class PersonController {

    private final PersonRepository personRepository;

    public PersonController(PersonRepository personRepository) {
        this.personRepository = personRepository;
    }

    @GetMapping("/{id}")
    public ResponseEntity<Person> getPerson(@PathVariable Long id) {
        Person person = personRepository.findById(id)
                .orElseThrow(() -> new RuntimeException("Person not found"));
        
        // ETag μƒμ„± (version ν•„λ“ ν™μ©)
        String eTag = "W/\"" + person.getVersion() + "\"";

        return ResponseEntity.ok()
                .eTag(eTag)
                .body(person);
    }

    @PutMapping("/{id}")
    public ResponseEntity<Person> updatePerson(
            @PathVariable Long id,
            @RequestHeader(value = "If-Match", required = false) String ifMatch,
            @RequestBody Person updatedPerson
    ) {
        Person existingPerson = personRepository.findById(id)
                .orElseThrow(() -> new RuntimeException("Person not found"));

        // ν„μ¬ λ²„μ „μΌλ΅λ¶€ν„° ETag μ¬μƒμ„±
        String currentETag = "W/\"" + existingPerson.getVersion() + "\"";

        // If-Match ν—¤λ”κ°€ μ—†κ±°λ‚, currentETagμ™€ λ¶μΌμΉν•λ©΄ 412 μ‘λ‹µ
        if (ifMatch == null || !ifMatch.equals(currentETag)) {
            return ResponseEntity.status(HttpStatus.PRECONDITION_FAILED).build();
        }

        // μ΄μ  μ•μ „ν•κ² μ—”ν‹°ν‹° μ—…λ°μ΄νΈ
        existingPerson.setName(updatedPerson.getName());
        // λ³€κ²½λ λ‚΄μ©μ„ DBμ— μ €μ¥ (version ν•„λ“λ” JPAκ°€ μλ™μΌλ΅ μ¦κ°€)
        personRepository.save(existingPerson);

        // μ—…λ°μ΄νΈ ν›„ μƒ ETag μƒμ„±
        String newETag = "W/\"" + existingPerson.getVersion() + "\"";

        return ResponseEntity.ok()
                .eTag(newETag)
                .body(existingPerson);
    }
}
```

## 6.4.10 if-modified-since
```HTTP
GET /index.html
if-Modified-Since: Thu, 15 Apr 2004 00:00:00 GMT
```
ν•΄λ‹Ή κ°’ μ΄ν›„λ΅ κ°±μ‹ λ μ μ΄ μμΌλ©΄ λ°›λ”λ‹¤λ” μλ―Έμ„.

κ°±μ‹ λ μ  μ—†μΌλ©΄ 304 Not Modified μ—λ¬ λ°μƒ. 

## 6.4.11 if-Non-Match
if-match λ°λ€

## 6.4.12 if-range
```http request
GET /index.html
if-Range: "12345"
Range: bytes=5001-10000
```
Etagλ‚ μμ • λ‚ μ§ μ΅°κ±΄μ΄ μΌμΉν•λ©΄, rangeλ¦¬ν€μ¤νΈλ΅ μ²λ¦¬ν•¨. 
μΌμΉν•μ§€ μ•μΌλ©΄ μ „μ²΄λ¥Ό λ°ν™ν•¨. 

if-matchμ™€ λΉ„κµν–μ„ λ• λ­κ°€ μΆ‹μ€κ±΄μ§€ λ¨λ¥΄κ² μ.γ…‹γ…‹

## 6.4.13 if-unmodified-since
if-modified-sinceμ λ°λ“λ§.

## 6.4.14 Max-forwards
forwarding ν•  μ μλ” νμλ¥Ό μ ν•ν•λ‹¤. μ΄λ” λ””λ²„κΉ…μ— μ‚¬μ©λλ‹¤. 

## 6.4.15 Proxy-Authorization
ν΄λΌμ΄μ–ΈνΈμ™€ ν”„λ΅μ‹ μ‚¬μ΄μ μΈμ¦ μ •λ³΄ μ €μ¥

## 6.4.16 Range
λ¦¬μ†μ¤μ μΌλ¶€λ¶„λ§ μ·¨λ“ν•κ³  μ‹¶μ„ λ• λ²”μ„ μ§€μ •ν•¨. 
μ΄ λ²”μ„λ΅ λ°ν™ κ°€λ¥ν•  λ• μ„λ²„λ” 206 Partial Content λ¦¬μ¤ν°μ¤λ¥Ό λ°ν™ν•¨. 

Rangeλ΅ λ°›μ•„λ“¤μ΄μ§€ λ»ν•  λ•λ” 200 OKλ΅ λ°ν™ν•κ³ , λ¦¬μ†μ¤ μ „μ²΄ λ°ν™.

μ™ λ²”μ„ μ”μ²­μ΄ μ‹¤ν¨ν•λ©΄ λ¦¬μ†μ¤ μ „μ²΄λ¥Ό λ°ν™ν• κΉ?
1οΈβƒ£ ν›„λ°© νΈν™μ„±(Backward Compatibility) λ•λ¬Έ

Range ν—¤λ”λ” HTTP/1.1μ—μ„ μ¶”κ°€λ κΈ°λ¥μ΄κ³ , HTTP/1.0μ—μ„λ” μ΅΄μ¬ν•μ§€ μ•μ•μ–΄.
HTTP/1.0κ³Ό νΈν™λλ„λ΅ ν΄λΌμ΄μ–ΈνΈκ°€ Rangeλ¥Ό μ§€μ›ν•μ§€ μ•λ” μ„λ²„μ™€λ„ μ •μƒμ μΈ ν†µμ‹ μ΄ κ°€λ¥ν•΄μ•Ό ν•΄.
μ¦‰, λ²”μ„ μ”μ²­μ΄ μ§€μ›λμ§€ μ•μ•„λ„ ν΄λΌμ΄μ–ΈνΈκ°€ μ •μƒμ μΌλ΅ λ¦¬μ†μ¤λ¥Ό λ°›μ„ μ μλ„λ΅ ν•κΈ° μ„ν•¨μ΄μ•Ό.
2οΈβƒ£ Range μ”μ²­μ΄ κ°•μ μ μΈ κ²ƒμ΄ μ•„λ‹κΈ° λ•λ¬Έ

ν΄λΌμ΄μ–ΈνΈλ” Range ν—¤λ”λ¥Ό λ³΄λ‚Ό μ μμ§€λ§, μ΄λ” **μ„ νƒμ μΈ κΈ°λ¥(optional feature)**μ΄μ•Ό.
μ„λ²„κ°€ λ¶€λ¶„ λ°ν™μ„ μ§€μ›ν•  μλ„ μκ³ , μ• ν•  μλ„ μμ–΄.
Range μ”μ²­μ΄ κ±°λ¶€λμ—μ„ λ•, μ„λ²„κ°€ μ•„μ μ‘λ‹µμ„ μ• ν•λ©΄ ν΄λΌμ΄μ–ΈνΈκ°€ λ°μ΄ν„°λ¥Ό μ „ν€ λ°›μ„ μ μ—†κΈ° λ•λ¬Έμ—, μ°¨μ„ μ±…μΌλ΅ μ „μ²΄ λ°μ΄ν„°λ¥Ό λ³΄λ‚΄λ” κ±°μ•Ό.
## 6.4.17 Refere
λ¦¬ν€μ¤νΈκ°€ λ°μƒν• λ³Έλ λ¦¬μ†μ¤μ URIμ „λ‹¬ν•¨.

π”Ή μμ : Referer ν—¤λ”μ λ™μ‘ λ°©μ‹
β… μ‚¬μ©μκ°€ example.com/page1.htmlμ—μ„ λ§ν¬λ¥Ό ν΄λ¦­ν•΄μ„ example.com/page2.htmlλ΅ μ΄λ™ν•  λ•
```http
GET /page2.html HTTP/1.1
Host: example.com
Referer: https://example.com/page1.html
```
Referer ν—¤λ”λ” μ‚¬μ©μκ°€ page2.htmlμ„ μ”μ²­ν•κΈ° μ „μ— μμ—λ νμ΄μ§€(page1.html)μ URLμ„ ν¬ν•¨ν•κ³  μμ.
page2.htmlμ μ„λ²„λ” **"μ΄ μ”μ²­μ΄ page1.htmlμ—μ„ λ°μƒν–λ‹¤"**λ” μ •λ³΄λ¥Ό μ•κ² λ¨.

## 6.4.18 TE
μ••μ¶• μΈμ½”λ”© ν•μ‹κ³Ό, μ°μ„ μμ„ ν¬ν•¨.

## 6.4.19 user-Agent
user-Agent μ •λ³΄λ¥Ό ν¬ν•¨ν•¨.

## 6.4.20 
